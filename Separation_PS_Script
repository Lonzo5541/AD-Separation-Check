Add-WindowsCapability -Name Rsat.ActiveDirectory.DS-LDS.Tools~~~~0.0.1.0 -Online

 

 

$UserCSV   = 'C:\Users\kenny.bae\downloads\waa.csv'

$OutputCSV = 'C:\Users\kenny.bae\downloads\waaaaaaa.csv'

 

$Users = Import-Csv -Path $UserCSV |

    Select-Object -ExpandProperty email

 

$Results =foreach( $User in $Users ){

    $Account = Get-ADUser -Filter { mail -eq $User }

 

    if( $Account ){

        $Account | Select-Object -Property SamAccountName, Enabled

        }

    else{

        [pscustomobject]@{

            SamAccountName = $User

            Enabled        = 'Account Not Found'

            }

        }

    }

 

$Results | Export-Csv -Path $OutputCSV -NoTypeInformation
